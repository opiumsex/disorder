<!DOCTYPE html>
<!-- saved from url=(0040)https://rococo-gnome-ab1f88.netlify.app/ -->
<html lang="ru"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSINT Lookup</title>
    <script defer="" src="./OSINT Lookup_files/libphonenumber-js.min.js"></script>
    <link rel="stylesheet" href="./OSINT Lookup_files/leaflet.css">
    <script defer="" src="./OSINT Lookup_files/leaflet.js"></script>
    <link rel="stylesheet" href="./OSINT Lookup_files/all.min.css">
    <script defer="" src="./OSINT Lookup_files/exif.min.js"></script>
    <script defer="" src="./OSINT Lookup_files/papaparse.min.js"></script>
    <link rel="stylesheet" href="./OSINT Lookup_files/all(1).min.css">
</head>

<body data-theme="black-red">
    <div class="container">
        <h1><i class="fas fa-search"></i> OSINT BY @kslox</h1>
        
        <div class="theme-selector">
            <button class="theme-btn" data-theme="green" title="–ó–µ–ª–µ–Ω–∞—è"><i class="fas fa-leaf"></i></button>
            <button class="theme-btn" data-theme="red" title="–ö—Ä–∞—Å–Ω–∞—è"><i class="fas fa-fire"></i></button>
            <button class="theme-btn" data-theme="blue" title="–°–∏–Ω—è—è"><i class="fas fa-water"></i></button>
            <button class="theme-btn" data-theme="gray" title="–°–µ—Ä–∞—è"><i class="fas fa-cloud"></i></button>
            <button class="theme-btn" data-theme="gray-red" title="–°–µ—Ä–æ-–∫—Ä–∞—Å–Ω–∞—è"><i class="fas fa-tint"></i></button>
            <button class="theme-btn" data-theme="black-red" title="–ß–µ—Ä–Ω–æ-–∫—Ä–∞—Å–Ω–∞—è"><i class="fas fa-skull"></i></button>
        </div>

        <div class="button-group">
            <button onclick="toggleInput(&#39;ip&#39;)"><i class="fas fa-network-wired"></i> IP</button>
            <button onclick="toggleInput(&#39;phone&#39;)"><i class="fas fa-phone"></i> –¢–µ–ª–µ—Ñ–æ–Ω</button>
            <button onclick="toggleInput(&#39;whois&#39;)"><i class="fas fa-globe"></i> WHOIS</button>
            <button onclick="toggleInput(&#39;username&#39;)"><i class="fas fa-user"></i> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</button>
            <button onclick="toggleInput(&#39;url&#39;)"><i class="fas fa-link"></i> URL</button>
            <button onclick="toggleInput(&#39;dns&#39;)"><i class="fas fa-server"></i> DNS</button>
            <button onclick="toggleInput(&#39;email&#39;)"><i class="fas fa-envelope"></i> Email</button>
            <button onclick="toggleInput(&#39;image&#39;)"><i class="fas fa-image"></i> –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</button>
            <button onclick="toggleInput(&#39;mac&#39;)"><i class="fas fa-ethernet"></i> MAC</button>
            <button onclick="toggleInput(&#39;domain&#39;)"><i class="fas fa-globe-americas"></i> –î–æ–º–µ–Ω</button>
            <button onclick="toggleInput(&#39;csv&#39;)"><i class="fas fa-file-csv"></i> CSV –ü–æ–∏—Å–∫</button>
            <button onclick="toggleInput(&#39;txt&#39;)"><i class="fas fa-file-alt"></i> TXT</button>
            <button onclick="toggleInput(&#39;portscan&#39;)"><i class="fas fa-door-open"></i> –ü–æ—Ä—Ç—ã</button>
            <button onclick="toggleInput(&#39;useragent&#39;)"><i class="fas fa-robot"></i> User-Agent</button>
            <button onclick="toggleInput(&#39;timezone&#39;)"><i class="fas fa-clock"></i> –í—Ä–µ–º—è</button>
            <button onclick="toggleInput(&#39;webarchive&#39;)"><i class="fas fa-history"></i> –ê—Ä—Ö–∏–≤</button>
            <button onclick="toggleInput(&#39;dorks&#39;)"><i class="fas fa-search-plus"></i> Dorks</button>
        </div>
        <div id="dorksSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-search-plus"></i>
                <select id="dorkType">
                    <option value="site">site: (–ø–æ–∏—Å–∫ –ø–æ —Å–∞–π—Ç—É)</option>
                    <option value="inurl">inurl: (–ø–æ–∏—Å–∫ –≤ URL)</option>
                    <option value="intitle">intitle: (–ø–æ–∏—Å–∫ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ)</option>
                    <option value="intext">intext: (–ø–æ–∏—Å–∫ —Ç–µ–∫—Å—Ç–∞)</option>
                    <option value="allinurl">allinurl: (–≤—Å–µ —Å–ª–æ–≤–∞ –≤ URL)</option>
                    <option value="filetype">filetype: (–ø–æ–∏—Å–∫ –ø–æ —Ç–∏–ø—É —Ñ–∞–π–ª–∞)</option>
                    <option value="ext">ext: (–ø–æ–∏—Å–∫ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é)</option>
                    <option value="cache">cache: (–∫—ç—à —Å—Ç—Ä–∞–Ω–∏—Ü—ã)</option>
                    <option value="related">related: (—Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–∞–π—Ç—ã)</option>
                    <option value="link">link: (—Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∞–π—Ç)</option>
                    <option value="minus">- (–∏—Å–∫–ª—é—á–∏—Ç—å —Å–ª–æ–≤–æ)</option>
                    <option value="quotes">"..." (—Ç–æ—á–Ω–∞—è —Ñ—Ä–∞–∑–∞)</option>
                    <option value="wildcard">* (–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π –∑–Ω–∞–∫)</option>
                    <option value="custom">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å</option>
                </select>
                <input type="text" id="dorkInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, example.com hacking)">
                <button onclick="generateDork()"><i class="fas fa-search"></i></button>
            </div>
            <div id="dorkResult" class="result-card"></div>
        </div>
        <div id="ipSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-network-wired"></i>
                <input type="text" id="ipInput" placeholder="–í–≤–µ–¥–∏—Ç–µ IP-–∞–¥—Ä–µ—Å">
                <button onclick="lookupIP()"><i class="fas fa-search"></i></button>
            </div>
            <div id="ipResult" class="result-card"></div>
        </div>
        
        <div id="phoneSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-phone"></i>
                <input type="text" id="phoneInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞">
                <button onclick="lookupPhone()"><i class="fas fa-search"></i></button>
            </div>
            <div id="phoneResult" class="result-card"></div>
        </div>

        <div id="whoisSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-globe"></i>
                <input type="text" id="whoisInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–æ–º–µ–Ω –∏–ª–∏ IP">
                <button onclick="lookupWhois()"><i class="fas fa-search"></i></button>
            </div>
            <div id="whoisResult" class="result-card"></div>
        </div>

        <div id="usernameSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-user"></i>
                <input type="text" id="usernameInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                <button onclick="lookupUsername()"><i class="fas fa-search"></i></button>
            </div>
            <div id="usernameResult" class="result-card"></div>
        </div>

        <div id="urlSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-link"></i>
                <input type="text" id="urlInput" placeholder="–í–≤–µ–¥–∏—Ç–µ URL">
                <button onclick="lookupURL()"><i class="fas fa-search"></i></button>
            </div>
            <div id="urlResult" class="result-card"></div>
        </div>

        <div id="dnsSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-server"></i>
                <input type="text" id="dnsInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–æ–º–µ–Ω">
                <button onclick="lookupDNS()"><i class="fas fa-search"></i></button>
            </div>
            <div id="dnsResult" class="result-card"></div>
        </div>

        <div id="emailSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-envelope"></i>
                <input type="text" id="emailInput" placeholder="–í–≤–µ–¥–∏—Ç–µ email">
                <button onclick="lookupEmail()"><i class="fas fa-search"></i></button>
            </div>
            <div id="emailResult" class="result-card"></div>
        </div>

        <div id="imageSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-image"></i>
                <input type="file" id="imageInput" accept="image/*">
                <button onclick="lookupImage()"><i class="fas fa-search"></i></button>
            </div>
            <div id="imageResult" class="result-card"></div>
        </div>

        <div id="macSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-ethernet"></i>
                <input type="text" id="macInput" placeholder="–í–≤–µ–¥–∏—Ç–µ MAC-–∞–¥—Ä–µ—Å">
                <button onclick="lookupMAC()"><i class="fas fa-search"></i></button>
            </div>
            <div id="macResult" class="result-card"></div>
        </div>

        <div id="domainSection" class="section">
            <div class="input-group">
                <i class="fas fa-globe-americas"></i>
                <input type="text" id="domainInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–æ–º–µ–Ω">
                <button onclick="lookupDomain()"><i class="fas fa-search"></i></button>
            </div>
            <div id="domainResult" class="result-card">
                    <div class="info-block">
                        <h3>üåê –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ–º–µ–Ω–µ</h3>
                        <p><strong>–î–æ–º–µ–Ω:</strong> hizzex.ru</p>
                        <p><strong>SSL –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã:</strong> –ù–µ –Ω–∞–π–¥–µ–Ω–æ</p>
                    </div>
                </div>
        </div>

        <div id="csvSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-file-csv"></i>
                <input type="file" id="csvInput" accept=".csv">
                <input type="text" id="csvQuery" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞">
                <button onclick="lookupCSV()"><i class="fas fa-search"></i></button>
            </div>
            <div id="csvResult" class="result-card"></div>
        </div>

        <div id="txtSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-file-alt"></i>
                <input type="file" id="txtInput" accept=".txt">
                <input type="text" id="txtQuery" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞">
                <button onclick="lookupTXT()"><i class="fas fa-search"></i></button>
            </div>
            <div id="txtResult" class="result-card"></div>
        </div>

        <div id="portscanSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-door-open"></i>
                <input type="text" id="portscanInput" placeholder="–í–≤–µ–¥–∏—Ç–µ IP –∏ –ø–æ—Ä—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, 192.168.1.1:80,443)">
                <button onclick="scanPorts()"><i class="fas fa-search"></i></button>
            </div>
            <div id="portscanResult" class="result-card"></div>
        </div>

        <div id="useragentSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-robot"></i>
                <input type="text" id="useragentInput" placeholder="–í–≤–µ–¥–∏—Ç–µ User-Agent">
                <button onclick="lookupUserAgent()"><i class="fas fa-search"></i></button>
            </div>
            <div id="useragentResult" class="result-card"></div>
        </div>

        <div id="timezoneSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-clock"></i>
                <input type="text" id="timezoneInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 14:30)">
                <button onclick="lookupTimezone()"><i class="fas fa-search"></i></button>
            </div>
            <div id="timezoneResult" class="result-card"></div>
        </div>

        <div id="webarchiveSection" class="section hidden">
            <div class="input-group">
                <i class="fas fa-history"></i>
                <input type="text" id="webarchiveInput" placeholder="–í–≤–µ–¥–∏—Ç–µ URL">
                <button onclick="lookupWebArchive()"><i class="fas fa-search"></i></button>
            </div>
            <div id="webarchiveResult" class="result-card"></div>
        </div>
        
        <footer>
            <a href="https://t.me/lemon_tool" target="_blank"><i class="fab fa-telegram"></i></a>
        </footer>
    </div>

    <style>
        :root {
            /* –ó–µ–ª–µ–Ω–∞—è —Ç–µ–º–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
            --primary-color: #00ff00;
            --primary-dark: #00cc00;
            --bg-gradient-start: #0d1117;
            --bg-gradient-end: #1a1f2b;
            --container-bg: rgba(22, 27, 34, 0.95);
            --section-bg: #1e252d;
            --input-bg: #2e3642;
            --result-bg: #252c36;
            --text-color: #ffffff;
            --shadow-color: rgba(0, 255, 0, 0.3);
        }
    
        [data-theme="red"] {
            --primary-color: #ff0000;
            --primary-dark: #cc0000;
            --shadow-color: rgba(255, 0, 0, 0.3);
        }
    
        [data-theme="blue"] {
            --primary-color: #00b7ff;
            --primary-dark: #0099cc;
            --shadow-color: rgba(0, 183, 255, 0.3);
        }
    
        [data-theme="gray"] {
            --primary-color: #b0b0b0;
            --primary-dark: #8c8c8c;
            --shadow-color: rgba(176, 176, 176, 0.3);
        }
    
        [data-theme="gray-red"] {
            --primary-color: #ff4444;
            --primary-dark: #cc3333;
            --bg-gradient-start: #2e2e2e;
            --bg-gradient-end: #4a4a4a;
            --container-bg: rgba(60, 60, 60, 0.95);
            --section-bg: #3a3a3a;
            --input-bg: #4f4f4f;
            --result-bg: #444444;
            --shadow-color: rgba(255, 68, 68, 0.3);
        }
    
        [data-theme="black-red"] {
            --primary-color: #ff1a1a;
            --primary-dark: #cc1414;
            --bg-gradient-start: #000000;
            --bg-gradient-end: #1a0000;
            --container-bg: rgba(20, 0, 0, 0.95);
            --section-bg: #1a0000;
            --input-bg: #2e1a1a;
            --result-bg: #220000;
            --shadow-color: rgba(255, 26, 26, 0.3);
        }
    
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
    
        body {
            font-family: 'Roboto', Arial, sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-end));
            color: var(--text-color);
            padding: 20px;
            min-height: 100vh;
            transition: background 0.5s ease;
        }
    
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 30px;
            background: var(--container-bg);
            border-radius: 25px;
            box-shadow: 0 12px 50px var(--shadow-color);
            transition: all 0.5s ease;
        }
    
        .container:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px var(--shadow-color);
        }
    
        h1 {
            font-size: 2.5em;
            text-align: center;
            color: var(--primary-color);
            text-shadow: 0 0 25px var(--shadow-color);
            margin-bottom: 30px;
            animation: glow 2s ease-in-out infinite alternate;
        }
    
        h1 i {
            margin-right: 12px;
            transition: transform 0.4s ease;
        }
    
        h1:hover i {
            transform: rotate(360deg);
        }
    
        .theme-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
    
        .theme-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-color);
            border: 2px solid var(--primary-dark);
            transition: all 0.4s ease;
        }
    
        .theme-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 15px var(--shadow-color);
        }
    
        .theme-btn:active {
            transform: scale(0.9);
        }
    
        .button-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
    
        button {
            padding: 12px 20px;
            background: linear-gradient(45deg, var(--primary-color), var(--primary-dark));
            border: none;
            border-radius: 15px;
            color: #000;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 5px 20px var(--shadow-color);
        }
    
        button:hover {
            transform: scale(1.05) translateY(-4px);
            box-shadow: 0 10px 30px var(--shadow-color);
            background: linear-gradient(45deg, var(--primary-dark), var(--primary-color));
        }
    
        button:active {
            transform: scale(0.95);
            box-shadow: 0 3px 15px var(--shadow-color);
        }
    
        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.6;
        }
    
        .section {
            margin: 20px 0;
            padding: 20px;
            background: var(--section-bg);
            border-radius: 20px;
            transition: all 0.6s ease;
            opacity: 0;
            transform: translateY(30px);
        }
    
        .section:not(.hidden) {
            opacity: 1;
            transform: translateY(0);
        }
    
        .hidden {
            display: none;
        }
    
        .input-group {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--input-bg);
            padding: 10px;
            border-radius: 15px;
            border: 2px solid transparent;
            transition: all 0.4s ease;
        }
    
        .input-group:hover {
            border-color: var(--primary-color);
            box-shadow: 0 0 20px var(--shadow-color);
        }
    
        .input-group i {
            padding: 10px;
            color: var(--primary-color);
            transition: transform 0.4s ease;
        }
    
        .input-group:hover i {
            transform: scale(1.15) rotate(10deg);
        }
    
        input, select {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            background: transparent;
            color: var(--text-color);
            font-size: 1em;
            outline: none;
            transition: all 0.4s ease;
        }
    
        input:focus, select:focus {
            background: rgba(255, 255, 255, 0.08);
            box-shadow: inset 0 0 12px var(--shadow-color);
        }
    
        .input-group button {
            padding: 10px 15px;
            border-radius: 10px;
        }
    
        .result-card {
            padding: 20px;
            background: var(--result-bg);
            border-radius: 15px;
            margin-top: 15px;
            box-shadow: inset 0 0 20px var(--shadow-color);
            font-family: 'Courier New', monospace;
            line-height: 1.6;
            max-height: 400px;
            overflow-y: auto;
            transition: all 0.6s ease;
            opacity: 0;
            transform: scale(0.9);
        }
    
        .result-card:not(:empty) {
            opacity: 1;
            transform: scale(1);
        }
    
        .result-card strong {
            color: var(--primary-color);
            text-shadow: 0 0 8px var(--shadow-color);
        }
    
        .info-block {
            margin-bottom: 20px;
            padding: 15px;
            background: var(--input-bg);
            border-radius: 12px;
            border-left: 5px solid var(--primary-color);
            transition: all 0.4s ease;
        }
    
        .info-block:hover {
            transform: translateX(8px);
            box-shadow: 0 8px 25px var(--shadow-color);
        }
    
        .info-block h3 {
            font-size: 1.2em;
            color: var(--primary-color);
            margin-bottom: 12px;
            transition: color 0.3s ease;
        }
    
        .info-block:hover h3 {
            color: var(--primary-dark);
        }
    
        #map {
            height: 300px;
            width: 100%;
            margin-top: 15px;
            border-radius: 8px;
        }
    
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: var(--result-bg);
            border-radius: 8px;
            overflow: hidden;
        }
    
        .result-table th, .result-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid var(--primary-color);
        }
    
        .result-table th {
            background: var(--input-bg);
            color: var(--primary-color);
            font-weight: bold;
        }
    
        .result-table td {
            color: var(--text-color);
        }
    
        .result-table tr:last-child td {
            border-bottom: none;
        }
    
        .result-table a {
            color: var(--primary-color);
            text-decoration: none;
        }
    
        .result-table a:hover {
            text-decoration: underline;
        }
    
        footer {
            margin-top: 30px;
            text-align: center;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
    
        footer a {
            color: var(--primary-color);
            font-size: 1.5em;
            transition: all 0.4s ease;
        }
    
        footer a:hover {
            color: var(--primary-dark);
            transform: scale(1.3) rotate(15deg);
        }
    
        @keyframes glow {
            from { text-shadow: 0 0 15px var(--shadow-color); }
            to { text-shadow: 0 0 25px var(--shadow-color); }
        }
    
        @media (max-width: 480px) {
            .container {
                padding: 15px;
                border-radius: 20px;
            }
            .button-group {
                grid-template-columns: 1fr;
            }
            .input-group {
                flex-direction: column;
            }
            input, .input-group button, select {
                width: 100%;
            }
            h1 {
                font-size: 2em;
            }
            .theme-selector {
                flex-wrap: wrap;
            }
            .match-card {
                flex: 1 1 100%;
            }
            #dorkResult .info-block {
                background: var(--input-bg, #2e3642); /* –Ø–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
                color: var(--text-color, #ffffff);
                font-size: 0.9em;
                padding: 15px;
            }
            #dorkResult {
                background: var(--result-bg, #252c36); /* –Ø–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
                max-height: 300px;
            }
        }
    
        .fancy-frame {
            border: 2px solid var(--primary-color);
            border-radius: 15px;
            padding: 20px;
            background: var(--section-bg);
            box-shadow: 0 8px 25px var(--shadow-color), inset 0 0 10px var(--shadow-color);
            transition: all 0.4s ease;
        }
    
        .fancy-frame:hover {
            transform: scale(1.02);
            box-shadow: 0 12px 35px var(--shadow-color), inset 0 0 15px var(--shadow-color);
        }
    
        .match-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }
    
        .match-card {
            flex: 1 1 calc(33% - 15px);
            background: var(--result-bg);
            border: 1px solid var(--primary-color);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 15px var(--shadow-color);
            transition: all 0.3s ease;
        }
    
        .match-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px var(--shadow-color);
        }
    
        .match-card h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.1em;
        }
    
        .vertical-list {
            list-style: none;
            padding: 0;
        }
    
        .vertical-list li {
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px dashed var(--primary-dark);
        }
    
        .vertical-list li:last-child {
            border-bottom: none;
        }
    
        .vertical-list li strong {
            color: var(--primary-color);
            margin-right: 5px;
        }
    
        .highlight {
            background: var(--primary-color);
            color: #000;
            padding: 2px 5px;
            border-radius: 3px;
        }
    
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }
    
        .pagination button {
            padding: 8px 12px;
            font-size: 1em;
        }
    
        .pagination span {
            color: var(--text-color);
        }
    
        /* –£—Å–∏–ª–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è #dorkResult */
        #dorkResult {
            background: var(--result-bg, #252c36) !important;
            color: var(--text-color, #ffffff) !important;
        }
    
        #dorkResult .info-block {
            background: var(--input-bg, #2e3642) !important;
            color: var(--text-color, #ffffff) !important;
        }
    
        #dorkResult .fancy-frame {
            background: var(--section-bg, #1e252d) !important;
            color: var(--text-color, #ffffff) !important;
        }
    </style>

    <script>
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º
        document.querySelectorAll('.theme-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const theme = btn.getAttribute('data-theme');
                document.body.setAttribute('data-theme', theme);
                localStorage.setItem('selectedTheme', theme);
            });
        });

        const savedTheme = localStorage.getItem('selectedTheme') || 'green';
        document.body.setAttribute('data-theme', savedTheme);

        const lang = {
            ru: {
                enterIp: "–í–≤–µ–¥–∏—Ç–µ IP-–∞–¥—Ä–µ—Å",
                invalidIp: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π IP-–∞–¥—Ä–µ—Å",
                enterPhone: "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
                invalidPhone: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
                enterWhois: "–í–≤–µ–¥–∏—Ç–µ –¥–æ–º–µ–Ω –∏–ª–∏ IP",
                invalidWhois: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –¥–æ–º–µ–Ω –∏–ª–∏ IP",
                enterUsername: "–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
                invalidUsername: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
                enterUrl: "–í–≤–µ–¥–∏—Ç–µ URL",
                invalidUrl: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π URL",
                enterDns: "–í–≤–µ–¥–∏—Ç–µ –¥–æ–º–µ–Ω",
                invalidDns: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –¥–æ–º–µ–Ω",
                enterEmail: "–í–≤–µ–¥–∏—Ç–µ email",
                invalidEmail: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email",
                enterImage: "–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",
                invalidImage: "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è",
                enterMac: "–í–≤–µ–¥–∏—Ç–µ MAC-–∞–¥—Ä–µ—Å",
                invalidMac: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π MAC-–∞–¥—Ä–µ—Å",
                enterDomain: "–í–≤–µ–¥–∏—Ç–µ –¥–æ–º–µ–Ω",
                invalidDomain: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –¥–æ–º–µ–Ω",
                enterCsv: "–ó–∞–≥—Ä—É–∑–∏—Ç–µ CSV –∏ –≤–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å",
                invalidCsv: "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ CSV –∏–ª–∏ –∑–∞–ø—Ä–æ—Å–∞",
                enterTxt: "–ó–∞–≥—Ä—É–∑–∏—Ç–µ TXT –∏ –≤–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å",
                invalidTxt: "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ TXT –∏–ª–∏ –∑–∞–ø—Ä–æ—Å–∞",
                fileTooLarge: "–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å. 500 –ú–ë)",
                enterPorts: "–í–≤–µ–¥–∏—Ç–µ IP –∏ –ø–æ—Ä—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, 192.168.1.1:80,443)",
                invalidPorts: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç IP –∏–ª–∏ –ø–æ—Ä—Ç–æ–≤",
                enterUserAgent: "–í–≤–µ–¥–∏—Ç–µ User-Agent",
                invalidUserAgent: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π User-Agent",
                enterTime: "–í–≤–µ–¥–∏—Ç–µ –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 14:30)",
                invalidTime: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏",
                enterWebArchive: "–í–≤–µ–¥–∏—Ç–µ URL",
                invalidWebArchive: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π URL –¥–ª—è –∞—Ä—Ö–∏–≤–∞",
                enterDork: "–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, example.com hacking)",
                invalidDork: "–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –¥–æ—Ä–∫–∞",
                generatedDork: "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å:",
                loading: "–ó–∞–≥—Ä—É–∑–∫–∞...",
                error: "–û—à–∏–±–∫–∞"
            }
        };
        const currentLang = 'ru';

        document.getElementById('ipInput').placeholder = lang[currentLang].enterIp;
        document.getElementById('phoneInput').placeholder = lang[currentLang].enterPhone;
        document.getElementById('whoisInput').placeholder = lang[currentLang].enterWhois;
        document.getElementById('usernameInput').placeholder = lang[currentLang].enterUsername;
        document.getElementById('urlInput').placeholder = lang[currentLang].enterUrl;
        document.getElementById('dnsInput').placeholder = lang[currentLang].enterDns;
        document.getElementById('emailInput').placeholder = lang[currentLang].enterEmail;
        document.getElementById('macInput').placeholder = lang[currentLang].enterMac;
        document.getElementById('domainInput').placeholder = lang[currentLang].enterDomain;
        document.getElementById('csvQuery').placeholder = "–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞";
        document.getElementById('txtQuery').placeholder = "–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞";
        document.getElementById('portscanInput').placeholder = lang[currentLang].enterPorts;
        document.getElementById('useragentInput').placeholder = lang[currentLang].enterUserAgent;
        document.getElementById('timezoneInput').placeholder = lang[currentLang].enterTime;
        document.getElementById('webarchiveInput').placeholder = lang[currentLang].enterWebArchive;
        document.getElementById('dorkInput').placeholder = lang[currentLang].enterDork;

        const cache = {
            get(key) { return JSON.parse(localStorage.getItem(key)); },
            set(key, value) { localStorage.setItem(key, JSON.stringify(value)); }
        };

        function toggleInput(type) {
            const sections = ['ipSection', 'phoneSection', 'whoisSection', 'usernameSection', 'urlSection', 'dnsSection', 'emailSection', 'imageSection', 'macSection', 'domainSection', 'csvSection', 'txtSection', 'portscanSection', 'useragentSection', 'timezoneSection', 'webarchiveSection', 'dorksSection'];
            const currentSection = document.getElementById(type + 'Section');

            sections.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (sectionId !== type + 'Section' && !section.classList.contains('hidden')) {
                    section.classList.add('hidden');
                }
            });

            currentSection.classList.toggle('hidden');
        }

        function isValidIP(ip) {
            const ipRegex = /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
            return ipRegex.test(ip);
        }

        function safeHTML(strings, ...values) {
            return strings.reduce((result, string, i) => {
                const value = values[i] ? String(values[i]).replace(/</g, '<').replace(/>/g, '>') : '';
                return result + string + value;
            }, '');
        }

        async function lookupIP() {
            const ip = document.getElementById('ipInput').value.trim();
            const button = document.querySelector('#ipSection button');
            const result = document.getElementById('ipResult');
            const cached = cache.get(`ip_${ip}`);

            if (!ip || !isValidIP(ip)) {
                alert(lang[currentLang].invalidIp);
                return;
            }

            if (cached) {
                result.innerHTML = cached;
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            const sources = [
                `http://ip-api.com/json/${ip}?fields=status,message,continent,continentCode,country,countryCode,region,regionName,city,district,zip,lat,lon,timezone,offset,currency,isp,org,as,asname,reverse,mobile,proxy,hosting,query&lang=ru`,
                `https://ipwhois.app/json/${ip}?lang=ru`,
                `http://ipinfo.io/${ip}/json`,
                `https://geolocation-db.com/json/${ip}&position=true`
            ];

            let data;
            for (const source of sources) {
                try {
                    const response = await fetch(source, { timeout: 10000 });
                    if (!response.ok) {
                        result.innerText += `\n‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ${source}: ${response.status}`;
                        continue;
                    }
                    data = await response.json();
                    if (data.status && data.status !== "success") {
                        result.innerText += `\n‚ö†Ô∏è ${source}: ${data.message || '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}`;
                        continue;
                    }
                    break;
                } catch (error) {
                    result.innerText += `\n‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ ${source}: ${error.message}`;
                }
            }

            if (!data) {
                result.innerText = "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∏ –æ—Ç –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞";
                button.disabled = false;
                return;
            }

            const resultHTML = `
                <div class="info-block">
                    <h3>üåê –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <p><strong>IP –ê–¥—Ä–µ—Å:</strong> ${data.query || data.ip || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                    <p><strong>–ö–æ–Ω—Ç–∏–Ω–µ–Ω—Ç:</strong> ${data.continent || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'} (${data.continentCode || 'N/A'})</p>
                    <p><strong>–°—Ç—Ä–∞–Ω–∞:</strong> ${data.country || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'} (${data.countryCode || 'N/A'})</p>
                    <p><strong>–†–µ–≥–∏–æ–Ω:</strong> ${data.regionName || data.region || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                    <p><strong>–ì–æ—Ä–æ–¥:</strong> ${data.city || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                    <p><strong>–ü–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å:</strong> ${data.zip || '–ù/–î'}</p>
                </div>
                <div class="info-block">
                    <h3>üì° –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <p><strong>–ü—Ä–æ–≤–∞–π–¥–µ—Ä:</strong> ${data.isp || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                    <p><strong>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è:</strong> ${data.org || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                    <p><strong>AS:</strong> ${data.as || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                    <p><strong>AS –ò–º—è:</strong> ${data.asname || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                </div>
                <div class="info-block">
                    <h3>üìç –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è</h3>
                    <p><strong>–®–∏—Ä–æ—Ç–∞:</strong> ${data.lat || '–ù/–î'}</p>
                    <p><strong>–î–æ–ª–≥–æ—Ç–∞:</strong> ${data.lon || '–ù/–î'}</p>
                    <p><strong>–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å:</strong> ${data.timezone || '–ù/–î'}</p>
                    <p><strong>–í–∞–ª—é—Ç–∞:</strong> ${data.currency || '–ù/–î'}</p>
                </div>
                <div class="info-block">
                    <h3>üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h3>
                    <p><strong>–ú–æ–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å:</strong> ${data.mobile ? '–î–∞' : '–ù–µ—Ç'}</p>
                    <p><strong>–ü—Ä–æ–∫—Å–∏/VPN:</strong> ${data.proxy ? '–î–∞' : '–ù–µ—Ç'}</p>
                    <p><strong>–•–æ—Å—Ç–∏–Ω–≥:</strong> ${data.hosting ? '–î–∞' : '–ù–µ—Ç'}</p>
                </div>
            `;

            result.innerHTML = resultHTML;

            if (data.lat && data.lon) {
                const mapDiv = document.createElement('div');
                mapDiv.id = 'map';
                result.appendChild(mapDiv);
                const map = L.map('map').setView([data.lat, data.lon], 13);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© OpenStreetMap'
                }).addTo(map);
                L.marker([data.lat, data.lon]).addTo(map)
                    .bindPopup(`${data.city || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}, ${data.country || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}`)
                    .openPopup();
            }

            cache.set(`ip_${ip}`, result.innerHTML);
            button.disabled = false;
        }

        async function lookupPhone() {
            const phone = document.getElementById('phoneInput').value.trim();
            const button = document.querySelector('#phoneSection button');
            const result = document.getElementById('phoneResult');
            const cached = cache.get(`phone_${phone}`);

            if (!phone) {
                alert(lang[currentLang].invalidPhone);
                return;
            }

            if (cached) {
                result.innerHTML = cached;
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            try {
                const parsedNumber = libphonenumber.parsePhoneNumber(phone);
                if (!parsedNumber.isValid()) {
                    result.innerText = "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞";
                    return;
                }

                const country = parsedNumber.country;
                const numberType = parsedNumber.getType();
                const nationalNumber = parsedNumber.formatNational();
                const internationalNumber = parsedNumber.formatInternational();
                const e164Number = parsedNumber.format('E.164');
                const whatsappLink = `https://wa.me/${phone.replace('+', '')}`;
                const viberLink = `viber://chat?number=${phone.replace('+', '')}`;
                const telegramLink = `https://t.me/${phone.replace('+', '')}`;

                const resultHTML = safeHTML`
                    <p><strong>–ù–æ–º–µ—Ä (–Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π):</strong> ${nationalNumber}</p>
                    <p><strong>–ù–æ–º–µ—Ä (–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π):</strong> ${internationalNumber}</p>
                    <p><strong>–ù–æ–º–µ—Ä (E.164):</strong> ${e164Number}</p>
                    <p><strong>–°—Ç—Ä–∞–Ω–∞:</strong> ${country}</p>
                    <p><strong>–¢–∏–ø –Ω–æ–º–µ—Ä–∞:</strong> ${numberType}</p>
                    <p><strong>WhatsApp:</strong> <a href="${whatsappLink}" target="_blank">–û—Ç–∫—Ä—ã—Ç—å</a></p>
                    <p><strong>Viber:</strong> <a href="${viberLink}" target="_blank">–û—Ç–∫—Ä—ã—Ç—å</a></p>
                    <p><strong>Telegram:</strong> <a href="${telegramLink}" target="_blank">–û—Ç–∫—Ä—ã—Ç—å</a></p>
                `;
                cache.set(`phone_${phone}`, resultHTML);
                result.innerHTML = resultHTML;
            } catch (error) {
                result.innerText = `${lang[currentLang].error}: ${error.message}`;
            } finally {
                button.disabled = false;
            }
        }

        async function lookupUsername() {
            const username = document.getElementById('usernameInput').value.trim();
            const button = document.querySelector('#usernameSection button');
            const result = document.getElementById('usernameResult');
            const cached = cache.get(`username_${username}`);
        
            if (!username) {
                alert(lang[currentLang].invalidUsername);
                return;
            }
        
            if (cached) {
                result.innerHTML = cached;
                return;
            }
        
            button.disabled = true;
            result.innerText = lang[currentLang].loading;
        
            // –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º
            const platforms = {
                "–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏": {
                    "Twitter": `https://twitter.com/${encodeURIComponent(username)}`,
                    "Instagram": `https://instagram.com/${encodeURIComponent(username)}`,
                    "Facebook": `https://facebook.com/${encodeURIComponent(username)}`,
                    "LinkedIn": `https://linkedin.com/in/${encodeURIComponent(username)}`,
                    "Pinterest": `https://pinterest.com/${encodeURIComponent(username)}`,
                    "Snapchat": `https://snapchat.com/add/${encodeURIComponent(username)}`,
                    "VK": `https://vk.com/${encodeURIComponent(username)}`,
                    "Odnoklassniki": `https://ok.ru/${encodeURIComponent(username)}`
                },
                "–°—Ç—Ä–∏–º–∏–Ω–≥ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç": {
                    "YouTube": `https://www.youtube.com/@${encodeURIComponent(username)}`,
                    "Twitch": `https://twitch.tv/${encodeURIComponent(username)}`,
                    "TikTok": `https://www.tiktok.com/@${encodeURIComponent(username)}`,
                    "Bilibili": `https://space.bilibili.com/${encodeURIComponent(username)}` // –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —Ç—Ä–µ–±—É–µ—Ç ID, –Ω–æ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º—è
                },
                "–ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã": {
                    "Telegram": `https://t.me/${encodeURIComponent(username)}`,
                    "Discord": `https://discord.com/users/${encodeURIComponent(username)}` // –¢—Ä–µ–±—É–µ—Ç ID, –Ω–æ –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å
                },
                "–§–æ—Ä—É–º—ã –∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞": {
                    "Reddit": `https://reddit.com/user/${encodeURIComponent(username)}`,
                    "GitHub": `https://github.com/${encodeURIComponent(username)}`,
                    "StackOverflow": `https://stackoverflow.com/users/${encodeURIComponent(username)}` // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
                },
                "–ò–≥—Ä–æ–≤—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã": {
                    "Steam": `https://steamcommunity.com/id/${encodeURIComponent(username)}`,
                    "Xbox": `https://xbox.com/en-US/profiles/${encodeURIComponent(username)}`,
                    "PlayStation": `https://psnprofiles.com/${encodeURIComponent(username)}`
                }
            };
        
            const found = {};
            const promises = [];
        
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
            for (const [category, sites] of Object.entries(platforms)) {
                found[category] = [];
                for (const [platform, url] of Object.entries(sites)) {
                    promises.push(
                        fetch(url, {
                            method: 'GET',
                            redirect: 'manual', // –£—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã
                            headers: {
                                'User-Agent': 'OSINT-Lookup/1.0 (Contact: your-email@example.com)'
                            },
                            timeout: 5000 // –¢–∞–π–º-–∞—É—Ç 5 —Å–µ–∫—É–Ω–¥
                        })
                        .then(response => {
                            if (response.status === 200) {
                                found[category].push({ platform, url });
                            }
                            // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º 404 –∏–ª–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
                        })
                        .catch(() => {
                            // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, CORS –∏–ª–∏ —Å–µ—Ç—å)
                        })
                    );
                }
            }
        
            await Promise.all(promises);
        
            // –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            let totalFound = 0;
            let resultHTML = `
                <div class="info-block fancy-frame">
                    <h3>üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                    <p><strong>–ù–∏–∫:</strong> ${username}</p>
            `;
        
            for (const [category, matches] of Object.entries(found)) {
                if (matches.length > 0) {
                    totalFound += matches.length;
                    resultHTML += `
                        <div class="match-container">
                            <h4>${category}</h4>
                            <ul class="vertical-list">
                                ${matches.map(match => `
                                    <li>
                                        ${match.platform}: <a href="${match.url}" target="_blank">${match.url}</a>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                    `;
                }
            }
        
            if (totalFound === 0) {
                resultHTML += `
                    <p>‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö</p>
                    <p>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ü—Ä–æ—Ñ–∏–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º, —É–¥–∞–ª—ë–Ω–Ω—ã–º –∏–ª–∏ –Ω–∏–∫ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.</p>
                `;
            } else {
                resultHTML += `
                    <p><strong>–ù–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π:</strong> ${totalFound}</p>
                `;
            }
        
            resultHTML += `</div>`;
            result.innerHTML = resultHTML;
            cache.set(`username_${username}`, resultHTML);
            button.disabled = false;
        }

        async function lookupURL() {
            const url = document.getElementById('urlInput').value.trim();
            const button = document.querySelector('#urlSection button');
            const result = document.getElementById('urlResult');
            const cached = cache.get(`url_${url}`);

            if (!url || !/^https?:\/\/\S+$/.test(url)) {
                alert(lang[currentLang].invalidUrl);
                return;
            }

            if (cached) {
                result.innerHTML = cached;
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            try {
                const domain = new URL(url).hostname;
                const response = await fetch(`https://ipwhois.app/json/${domain}`);
                const data = await response.json();

                if (!response.ok || data.success === false) {
                    result.innerText = "–î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã";
                    return;
                }

                const resultHTML = safeHTML`
                    <p><strong>URL:</strong> ${url}</p>
                    <p><strong>–î–æ–º–µ–Ω:</strong> ${data.query || 'N/A'}</p>
                    <p><strong>–°—Ç—Ä–∞–Ω–∞:</strong> ${data.country || 'N/A'}</p>
                    <p><strong>–ì–æ—Ä–æ–¥:</strong> ${data.city || 'N/A'}</p>
                    <p><strong>–ü—Ä–æ–≤–∞–π–¥–µ—Ä:</strong> ${data.isp || 'N/A'}</p>
                    <p><strong>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è:</strong> ${data.org || 'N/A'}</p>
                `;
                cache.set(`url_${url}`, resultHTML);
                result.innerHTML = resultHTML;
            } catch (error) {
                result.innerText = `${lang[currentLang].error}: ${error.message}`;
            } finally {
                button.disabled = false;
            }
        }

        async function lookupDNS() {
            const domain = document.getElementById('dnsInput').value.trim();
            const button = document.querySelector('#dnsSection button');
            const result = document.getElementById('dnsResult');
            const cached = cache.get(`dns_${domain}`);

            if (!domain || !/\w+\.\w+/.test(domain)) {
                alert(lang[currentLang].invalidDns);
                return;
            }

            if (cached) {
                result.innerHTML = cached;
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            try {
                const response = await fetch(`https://dns.google/resolve?name=${domain}`);
                const data = await response.json();

                if (!data.Answer) {
                    result.innerText = "DNS –∑–∞–ø–∏—Å–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã";
                    return;
                }

                const records = data.Answer.map(a => {
                    const type = a.type === 1 ? 'A' : a.type === 15 ? 'MX' : a.type === 2 ? 'NS' : `–¢–∏–ø ${a.type}`;
                    return `${type}: ${a.data}`;
                }).join('\n');
                const resultHTML = safeHTML`<pre>${records}</pre>`;
                cache.set(`dns_${domain}`, resultHTML);
                result.innerHTML = resultHTML;
            } catch (error) {
                result.innerText = `${lang[currentLang].error}: ${error.message}`;
            } finally {
                button.disabled = false;
            }
        }

        async function lookupEmail() {
            const email = document.getElementById('emailInput').value.trim();
            const button = document.querySelector('#emailSection button');
            const result = document.getElementById('emailResult');
            const cached = cache.get(`email_${email}`);

            if (!email || !/\S+@\S+\.\S+/.test(email)) {
                alert(lang[currentLang].invalidEmail);
                return;
            }

            if (cached) {
                result.innerHTML = cached;
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            try {
                const response = await fetch(`https://haveibeenpwned.com/api/v3/breachedaccount/${encodeURIComponent(email)}`, {
                    headers: { "User-Agent": "OSINT-Lookup", "hibp-api-key": "" }
                });
                const breaches = response.ok ? await response.json() : [];

                const resultHTML = `
                    <div class="info-block">
                        <h3>üìß –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± Email</h3>
                        <p><strong>Email:</strong> ${email}</p>
                        <p><strong>–£—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö:</strong> ${breaches.length ? breaches.map(b => b.Name).join(", ") : "–ù–µ –Ω–∞–π–¥–µ–Ω–æ"}</p>
                    </div>
                `;
                result.innerHTML = resultHTML;
                cache.set(`email_${email}`, resultHTML);
            } catch (error) {
                result.innerText = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
            } finally {
                button.disabled = false;
            }
        }

        function lookupImage() {
            const fileInput = document.getElementById('imageInput');
            const button = document.querySelector('#imageSection button');
            const result = document.getElementById('imageResult');
            const file = fileInput.files[0];

            if (!file) {
                alert(lang[currentLang].invalidImage);
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            EXIF.getData(file, function() {
                const exifData = EXIF.getAllTags(this);
                const resultHTML = `
                    <div class="info-block">
                        <h3>üñºÔ∏è –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h3>
                        <p><strong>–ò–º—è —Ñ–∞–π–ª–∞:</strong> ${file.name}</p>
                        <p><strong>–î–∞—Ç–∞:</strong> ${exifData.DateTimeOriginal || '–ù/–î'}</p>
                        <p><strong>–ö–∞–º–µ—Ä–∞:</strong> ${exifData.Model || '–ù/–î'}</p>
                        <p><strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å:</strong> ${exifData.Make || '–ù/–î'}</p>
                        <p><strong>–®–∏—Ä–æ—Ç–∞:</strong> ${exifData.GPSLatitude ? EXIF.getGPS(exifData.GPSLatitude) : '–ù/–î'}</p>
                        <p><strong>–î–æ–ª–≥–æ—Ç–∞:</strong> ${exifData.GPSLongitude ? EXIF.getGPS(exifData.GPSLongitude) : '–ù/–î'}</p>
                    </div>
                `;
                result.innerHTML = resultHTML;

                if (exifData.GPSLatitude && exifData.GPSLongitude) {
                    const lat = EXIF.getGPS(exifData.GPSLatitude);
                    const lon = EXIF.getGPS(exifData.GPSLongitude);
                    const mapDiv = document.createElement('div');
                    mapDiv.id = 'map';
                    result.appendChild(mapDiv);
                    const map = L.map('map').setView([lat, lon], 13);
                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '¬© OpenStreetMap'
                    }).addTo(map);
                    L.marker([lat, lon]).addTo(map).bindPopup('–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–æ—Ç–æ').openPopup();
                }

                cache.set(`image_${file.name}`, result.innerHTML);
                button.disabled = false;
            });

            EXIF.getGPS = function(coord) {
                if (!coord) return 0;
                return coord[0] + coord[1] / 60 + coord[2] / 3600;
            };
        }

        async function lookupMAC() {
            const mac = document.getElementById('macInput').value.trim().toUpperCase();
            const button = document.querySelector('#macSection button');
            const result = document.getElementById('macResult');
            const cached = cache.get(`mac_${mac}`);

            if (!mac || !/^([0-9A-F]{2}[:-]){5}([0-9A-F]{2})$/.test(mac)) {
                alert(lang[currentLang].invalidMac);
                return;
            }

            if (cached) {
                result.innerHTML = cached;
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            const oui = mac.split(/[:-]/).slice(0, 3).join("-");
            const sources = [
                `https://macvendors.com/api/${oui}`,
                `https://api.maclookup.app/v2/macs/${oui}`
            ];

            try {
                let data;
                for (const source of sources) {
                    try {
                        const response = await fetch(source, { timeout: 5000 });
                        if (!response.ok) {
                            result.innerText += `\n‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ ${source}`;
                            continue;
                        }
                        data = await response.json();
                        if (source.includes("macvendors.com") && data.company) break;
                        if (source.includes("maclookup.app") && data.found && data.company) break;
                    } catch (err) {
                        result.innerText += `\n‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ ${source}: ${err.message}`;
                        continue;
                    }
                }

                if (!data || (!data.company && !data.found)) {
                    result.innerText = "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∏ –æ—Ç –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞";
                    return;
                }

                const company = data.company || "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";
                const resultHTML = `
                    <div class="info-block">
                        <h3>üì° –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ MAC-–∞–¥—Ä–µ—Å–µ</h3>
                        <p><strong>MAC:</strong> ${mac}</p>
                        <p><strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å:</strong> ${company}</p>
                    </div>
                `;
                result.innerHTML = resultHTML;
                cache.set(`mac_${mac}`, resultHTML);
            } catch (error) {
                result.innerText = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
            } finally {
                button.disabled = false;
            }
        }
        async function lookupWhois() {
            const input = document.getElementById('whoisInput').value.trim();
            const button = document.querySelector('#whoisSection button');
            const result = document.getElementById('whoisResult');
            const cached = cache.get(`whois_${input}`);
        
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –≤–≤–æ–¥–∞ (–¥–æ–º–µ–Ω –∏–ª–∏ IP)
            if (!input || !/^(?:\w+\.\w+|\d+\.\d+\.\d+\.\d+)$/.test(input)) {
                alert(lang[currentLang].invalidWhois);
                return;
            }
        
            if (cached) {
                result.innerHTML = cached;
                return;
            }
        
            button.disabled = true;
            result.innerText = lang[currentLang].loading;
        
            const sources = [
                `https://ipwhois.app/json/${encodeURIComponent(input)}?lang=ru`,
                `https://whoisjs.com/api/whois/${encodeURIComponent(input)}`
            ];
        
            let data = null;
            for (const source of sources) {
                try {
                    const response = await fetch(source, {
                        headers: {
                            'User-Agent': 'OSINT-Lookup/1.0 (Contact: your-email@example.com)',
                            'Accept': 'application/json'
                        },
                        timeout: 10000 // –¢–∞–π–º-–∞—É—Ç 10 —Å–µ–∫—É–Ω–¥
                    });
        
                    if (!response.ok) {
                        result.innerText += `\n‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ${source}: ${response.status}`;
                        continue;
                    }
        
                    data = await response.json();
                    if (source.includes('ipwhois.app') && data.success === false) {
                        result.innerText += `\n‚ö†Ô∏è ${source}: ${data.message || '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}`;
                        continue;
                    }
                    if (source.includes('whoisjs.com') && !data.domain_name) {
                        result.innerText += `\n‚ö†Ô∏è ${source}: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö`;
                        continue;
                    }
                    break; // –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ, –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞
                } catch (error) {
                    result.innerText += `\n‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ ${source}: ${error.message}`;
                }
            }
        
            if (!data) {
                result.innerHTML = `
                    <div class="info-block">
                        <h3>üåê WHOIS –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <p><strong>–í–≤–æ–¥:</strong> ${input}</p>
                        <p>‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∏ –æ—Ç –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞</p>
                    </div>
                `;
                button.disabled = false;
                return;
            }
        
            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞
            let resultHTML;
            if (data.success !== undefined) { // ipwhois.app
                resultHTML = `
                    <div class="info-block fancy-frame">
                        <h3>üåê WHOIS –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <p><strong>–î–æ–º–µ–Ω/IP:</strong> ${data.query || input}</p>
                        <p><strong>–°—Ç—Ä–∞–Ω–∞:</strong> ${data.country || '–ù/–î'} (${data.country_code || 'N/A'})</p>
                        <p><strong>–†–µ–≥–∏–æ–Ω:</strong> ${data.region || '–ù/–î'}</p>
                        <p><strong>–ì–æ—Ä–æ–¥:</strong> ${data.city || '–ù/–î'}</p>
                        <p><strong>–ü—Ä–æ–≤–∞–π–¥–µ—Ä:</strong> ${data.isp || '–ù/–î'}</p>
                        <p><strong>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è:</strong> ${data.org || '–ù/–î'}</p>
                        <p><strong>AS:</strong> ${data.asn || '–ù/–î'}</p>
                    </div>
                `;
            } else { // whoisjs.com
                resultHTML = `
                    <div class="info-block fancy-frame">
                        <h3>üåê WHOIS –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <p><strong>–î–æ–º–µ–Ω:</strong> ${data.domain_name || input}</p>
                        <p><strong>–†–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä:</strong> ${data.registrar || '–ù/–î'}</p>
                        <p><strong>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> ${data.creation_date || '–ù/–î'}</p>
                        <p><strong>–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:</strong> ${data.updated_date || '–ù/–î'}</p>
                        <p><strong>–î–∞—Ç–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è:</strong> ${data.expiration_date || '–ù/–î'}</p>
                        <p><strong>–°–µ—Ä–≤–µ—Ä–∞ –∏–º–µ–Ω:</strong> ${data.name_servers?.join(', ') || '–ù/–î'}</p>
                        <p><strong>–°—Ç–∞—Ç—É—Å:</strong> ${data.status?.join(', ') || '–ù/–î'}</p>
                    </div>
                `;
            }
        
            result.innerHTML = resultHTML;
            cache.set(`whois_${input}`, resultHTML);
            button.disabled = false;
        }
        async function lookupDomain() {
            const domain = document.getElementById('domainInput').value.trim();
            const button = document.querySelector('#domainSection button');
            const result = document.getElementById('domainResult');
            const cached = cache.get(`domain_${domain}`);

            if (!domain || !/\w+\.\w+/.test(domain)) {
                alert(lang[currentLang].invalidDomain);
                return;
            }

            if (cached) {
                result.innerHTML = cached;
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            try {
                const response = await fetch(`https://crt.sh/?q=${domain}&output=json`);
                const certs = await response.json();
                const certInfo = certs.slice(0, 5).map(cert => cert.name_value).join(", ");

                const resultHTML = `
                    <div class="info-block">
                        <h3>üåê –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ–º–µ–Ω–µ</h3>
                        <p><strong>–î–æ–º–µ–Ω:</strong> ${domain}</p>
                        <p><strong>SSL –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã:</strong> ${certInfo || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ'}</p>
                    </div>
                `;
                result.innerHTML = resultHTML;
                cache.set(`domain_${domain}`, resultHTML);
            } catch (error) {
                result.innerText = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
            } finally {
                button.disabled = false;
            }
        }
        function generateDork() {
            const dorkType = document.getElementById('dorkType').value; // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
            const input = document.getElementById('dorkInput').value.trim(); // –ü–æ–ª—É—á–∞–µ–º –≤–≤–µ–¥–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Ç–µ–∫—Å—Ç –∏ —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
            const button = document.querySelector('#dorksSection button'); // –ù–∞—Ö–æ–¥–∏–º –∫–Ω–æ–ø–∫—É –≤ —Å–µ–∫—Ü–∏–∏ Dorks
            const result = document.getElementById('dorkResult'); // –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            const cached = cache.get(`dork_${dorkType}_${input}`); // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫—ç—à–µ
        
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–π –≤–≤–æ–¥
            if (!input) {
                alert(lang[currentLang].invalidDork); // –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –≤–≤–µ–¥–µ–Ω–æ
                return;
            }
        
            // –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –µ—Å—Ç—å –≤ –∫—ç—à–µ, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –µ–≥–æ –∏ –≤—ã—Ö–æ–¥–∏–º
            if (cached) {
                result.innerHTML = cached;
                return;
            }
        
            button.disabled = true; // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
            result.innerText = lang[currentLang].loading; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º "–ó–∞–≥—Ä—É–∑–∫–∞..."
        
            // –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏
            const operators = {
                'site': { desc: '–ü–æ–∏—Å–∫ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å–∞–π—Ç—É', example: 'site:example.com hacking' },
                'inurl': { desc: '–ü–æ–∏—Å–∫ –≤ URL', example: 'inurl:login' },
                'intitle': { desc: '–ü–æ–∏—Å–∫ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã', example: 'intitle:"index of"' },
                'intext': { desc: '–ü–æ–∏—Å–∫ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ', example: 'intext:password' },
                'allinurl': { desc: '–í—Å–µ —Å–ª–æ–≤–∞ –≤ URL', example: 'allinurl:admin login' },
                'filetype': { desc: '–ü–æ–∏—Å–∫ –ø–æ —Ç–∏–ø—É —Ñ–∞–π–ª–∞', example: 'filetype:pdf site:*.edu' },
                'ext': { desc: '–ü–æ–∏—Å–∫ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é —Ñ–∞–π–ª–∞', example: 'ext:log site:example.com' },
                'cache': { desc: '–ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å–∞–π—Ç–∞', example: 'cache:example.com' },
                'related': { desc: '–°–≤—è–∑–∞–Ω–Ω—ã–µ —Å–∞–π—Ç—ã', example: 'related:example.com' },
                'link': { desc: '–°—Å—ã–ª–∫–∏ –Ω–∞ —Å–∞–π—Ç', example: 'link:example.com' },
                'minus': { desc: '–ò—Å–∫–ª—é—á–∏—Ç—å —Å–ª–æ–≤–æ', example: 'hacking -inurl:login' },
                'quotes': { desc: '–¢–æ—á–Ω–∞—è —Ñ—Ä–∞–∑–∞', example: '"admin panel"' },
                'wildcard': { desc: '–ü–æ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π –∑–Ω–∞–∫', example: 'site:*.org login' },
                'custom': { desc: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å', example: 'site:example.com intext:login' } // –î–æ–±–∞–≤–ª–µ–Ω custom –≤ –æ–±—ä–µ–∫—Ç
            };
        
            // –ü–∞—Ä—Å–∏–Ω–≥ –≤–≤–æ–¥–∞ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞
            let query = '';
            if (dorkType === 'custom') {
                query = input; // –î–ª—è custom –±–µ—Ä–µ–º –≤–≤–æ–¥ –∫–∞–∫ –µ—Å—Ç—å
            } else {
                const parts = input.split(' ').filter(part => part); // –†–∞–∑–¥–µ–ª—è–µ–º –≤–≤–æ–¥ –Ω–∞ —Å–ª–æ–≤–∞, —É–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ
                query = parts.map(part => {
                    // –ï—Å–ª–∏ —á–∞—Å—Ç—å —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä (-, ", *), –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
                    if (part.startsWith('-') || part.startsWith('"') || part.includes('*')) {
                        return part;
                    }
                    return `${dorkType}:${part}`; // –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∫ –∫–∞–∂–¥–æ–º—É —Å–ª–æ–≤—É
                }).join(' ');
            }
        
            // –§–æ—Ä–º–∏—Ä—É–µ–º URL –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–æ–∏—Å–∫–æ–≤–∏–∫–æ–≤
            const googleUrl = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
            const bingUrl = `https://www.bing.com/search?q=${encodeURIComponent(query)}`;
            const duckduckgoUrl = `https://duckduckgo.com/?q=${encodeURIComponent(query)}`;
        
            // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            const resultHTML = `
                <div class="info-block fancy-frame">
                    <h3>üîç Google Dork</h3>
                    <p><strong>–¢–∏–ø –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞:</strong> ${operators[dorkType]?.desc || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å'}</p>
                    <p><strong>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å:</strong> <span id="dorkQuery">${query}</span></p>
                    <button onclick="navigator.clipboard.writeText('${query.replace(/'/g, "\\'")}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å</button>
                    <div class="match-container">
                        <h4>–ü–æ–∏—Å–∫ –≤:</h4>
                        <ul class="vertical-list">
                            <li><a href="${googleUrl}" target="_blank">Google</a></li>
                            <li><a href="${bingUrl}" target="_blank">Bing</a></li>
                            <li><a href="${duckduckgoUrl}" target="_blank">DuckDuckGo</a></li>
                        </ul>
                    </div>
                    <div class="match-container">
                        <h4>–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</h4>
                        <ul class="vertical-list">
                            <li>${operators[dorkType]?.example || 'site:example.com intext:login'}</li>
                            <li>site:*.edu filetype:pdf "research paper"</li>
                            <li>inurl:(login | admin) -intext:"sign up"</li>
                        </ul>
                    </div>
                </div>
            `;
        
            result.innerHTML = resultHTML; // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            cache.set(`dork_${dorkType}_${input}`, resultHTML); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à
            button.disabled = false; // –í–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –æ–±—Ä–∞—Ç–Ω–æ
        }
        function lookupCSV() {
            const fileInput = document.getElementById('csvInput');
            const query = document.getElementById('csvQuery').value.trim();
            const button = document.querySelector('#csvSection button');
            const result = document.getElementById('csvResult');
            const file = fileInput.files[0];
            const MAX_FILE_SIZE = 2000 * 1024 * 1024; // 500 –ú–ë –≤ –±–∞–π—Ç–∞—Ö
            const ITEMS_PER_PAGE = 5;

            if (!file || !query) {
                alert(lang[currentLang].invalidCsv);
                return;
            }

            if (file.size > MAX_FILE_SIZE) {
                alert(lang[currentLang].fileTooLarge);
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            Papa.parse(file, {
                header: true,
                skipEmptyLines: true,
                complete: function(results) {
                    const data = results.data;
                    const totalLines = data.length;
                    const matches = data.filter(row => 
                        Object.values(row).some(value => 
                            value && value.toString().toLowerCase().includes(query.toLowerCase())
                        )
                    );

                    if (matches.length === 0) {
                        result.innerHTML = `
                            <div class="info-block fancy-frame">
                                <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –≤ CSV</h3>
                                <p><strong>–§–∞–π–ª:</strong> ${file.name} (${(file.size / 1024).toFixed(2)} –ö–ë)</p>
                                <p><strong>–ó–∞–ø—Ä–æ—Å:</strong> ${query}</p>
                                <p>‚ùå –°–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
                            </div>
                        `;
                    } else {
                        let currentPage = 1;
                        const totalPages = Math.ceil(matches.length / ITEMS_PER_PAGE);

                        function renderPage(page) {
                            const start = (page - 1) * ITEMS_PER_PAGE;
                            const end = start + ITEMS_PER_PAGE;
                            const paginatedMatches = matches.slice(start, end);

                            let resultHTML = `
                                <div class="info-block fancy-frame">
                                    <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –≤ CSV</h3>
                                    <p><strong>–§–∞–π–ª:</strong> ${file.name} (${(file.size / 1024).toFixed(2)} –ö–ë)</p>
                                    <p><strong>–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫:</strong> ${totalLines}</p>
                                    <p><strong>–ó–∞–ø—Ä–æ—Å:</strong> ${query}</p>
                                    <p><strong>–ù–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π:</strong> ${matches.length}</p>
                                    <button onclick="downloadResults('csv')">üíæ –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                                    <div class="match-container">
                            `;

                            paginatedMatches.forEach((row, index) => {
                                resultHTML += `
                                    <div class="match-card">
                                        <h4>–ó–∞–ø–∏—Å—å ${start + index + 1}</h4>
                                        <ul class="vertical-list">
                                            ${Object.entries(row).map(([key, value]) => {
                                                const text = value ? value.toString() : 'N/A';
                                                const highlighted = text.toLowerCase().includes(query.toLowerCase())
                                                    ? `<span class="highlight">${text}</span>`
                                                    : text;
                                                return `<li><strong>${key}:</strong> ${text.match(/^https?:\/\//) ? `<a href="${text}" target="_blank">${highlighted}</a>` : highlighted}</li>`;
                                            }).join('')}
                                        </ul>
                                    </div>
                                `;
                            });

                            resultHTML += `
                                    </div>
                                    <div class="pagination">
                                        <button onclick="renderPage(${page - 1})" ${page === 1 ? 'disabled' : ''}>‚¨ÖÔ∏è</button>
                                        <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ ${page} –∏–∑ ${totalPages}</span>
                                        <button onclick="renderPage(${page + 1})" ${page === totalPages ? 'disabled' : ''}>‚û°Ô∏è</button>
                                    </div>
                                </div>
                            `;
                            result.innerHTML = resultHTML;

                            window.downloadResults = function(format) {
                                const csvContent = Papa.unparse(matches);
                                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                                const link = document.createElement('a');
                                link.href = URL.createObjectURL(blob);
                                link.download = `search_results_${query}.csv`;
                                link.click();
                            };
                        }

                        renderPage(currentPage);
                        window.renderPage = renderPage;
                    }
                    button.disabled = false;
                },
                error: function(error) {
                    result.innerText = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
                    button.disabled = false;
                }
            });
        }

        function lookupTXT() {
            const fileInput = document.getElementById('txtInput');
            const query = document.getElementById('txtQuery').value.trim();
            const button = document.querySelector('#txtSection button');
            const result = document.getElementById('txtResult');
            const file = fileInput.files[0];
            const MAX_FILE_SIZE = 2000 * 1024 * 1024; // 500 –ú–ë –≤ –±–∞–π—Ç–∞—Ö
            const ITEMS_PER_PAGE = 5;

            if (!file || !query) {
                alert(lang[currentLang].invalidTxt);
                return;
            }

            if (file.size > MAX_FILE_SIZE) {
                alert(lang[currentLang].fileTooLarge);
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                const lines = text.split('\n');
                const totalLines = lines.length;
                const matches = lines.filter(line => line.toLowerCase().includes(query.toLowerCase()));

                if (matches.length === 0) {
                    result.innerHTML = `
                        <div class="info-block fancy-frame">
                            <h3>üìù –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –≤ TXT</h3>
                            <p><strong>–§–∞–π–ª:</strong> ${file.name} (${(file.size / 1024).toFixed(2)} –ö–ë)</p>
                            <p><strong>–ó–∞–ø—Ä–æ—Å:</strong> ${query}</p>
                            <p>‚ùå –°–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
                        </div>
                    `;
                } else {
                    let currentPage = 1;
                    const totalPages = Math.ceil(matches.length / ITEMS_PER_PAGE);

                    function renderPage(page) {
                        const start = (page - 1) * ITEMS_PER_PAGE;
                        const end = start + ITEMS_PER_PAGE;
                        const paginatedMatches = matches.slice(start, end);

                        let resultHTML = `
                            <div class="info-block fancy-frame">
                                <h3>üìù –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –≤ TXT</h3>
                                <p><strong>–§–∞–π–ª:</strong> ${file.name} (${(file.size / 1024).toFixed(2)} –ö–ë)</p>
                                <p><strong>–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫:</strong> ${totalLines}</p>
                                <p><strong>–ó–∞–ø—Ä–æ—Å:</strong> ${query}</p>
                                <p><strong>–ù–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π:</strong> ${matches.length}</p>
                                <button onclick="downloadResults('txt')">üíæ –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                                <div class="match-container">
                        `;

                        paginatedMatches.forEach((line, index) => {
                            const highlighted = line.replace(
                                new RegExp(`(${query})`, 'gi'),
                                '<span class="highlight">$1</span>'
                            );
                            resultHTML += `
                                <div class="match-card">
                                    <h4>–°—Ç—Ä–æ–∫–∞ ${start + index + 1}</h4>
                                    <ul class="vertical-list">
                                        <li>${highlighted}</li>
                                    </ul>
                                </div>
                            `;
                        });

                        resultHTML += `
                                </div>
                                <div class="pagination">
                                    <button onclick="renderPage(${page - 1})" ${page === 1 ? 'disabled' : ''}>‚¨ÖÔ∏è</button>
                                    <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ ${page} –∏–∑ ${totalPages}</span>
                                    <button onclick="renderPage(${page + 1})" ${page === totalPages ? 'disabled' : ''}>‚û°Ô∏è</button>
                                </div>
                            </div>
                        `;
                        result.innerHTML = resultHTML;

                        window.downloadResults = function(format) {
                            const blob = new Blob([matches.join('\n')], { type: 'text/plain;charset=utf-8;' });
                            const link = document.createElement('a');
                            link.href = URL.createObjectURL(blob);
                            link.download = `search_results_${query}.txt`;
                            link.click();
                        };
                    }

                    renderPage(currentPage);
                    window.renderPage = renderPage;
                }
                button.disabled = false;
            };

            reader.onerror = function() {
                result.innerText = `‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: ${reader.error.message}`;
                button.disabled = false;
            };

            reader.readAsText(file);
        }

        async function scanPorts() {
            const input = document.getElementById('portscanInput').value.trim();
            const button = document.querySelector('#portscanSection button');
            const result = document.getElementById('portscanResult');
            const cached = cache.get(`portscan_${input}`);

            if (!input || !/^\d+\.\d+\.\d+\.\d+:[\d,]+$/.test(input)) {
                alert(lang[currentLang].invalidPorts);
                return;
            }

            if (cached) {
                result.innerHTML = cached;
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            try {
                const [ip, portsStr] = input.split(':');
                const ports = portsStr.split(',').map(Number);
                const apiUrl = `https://api.hackertarget.com/nmap/?q=${ip}`;
                
                const response = await fetch(apiUrl);
                if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ API');
                
                const data = await response.text();
                const lines = data.split('\n');
                const openPorts = lines.filter(line => 
                    ports.some(port => line.includes(` ${port}/tcp`) && line.includes('open'))
                );

                const resultHTML = `
                    <div class="info-block">
                        <h3>üîç –°–∫–∞–Ω–µ—Ä –ø–æ—Ä—Ç–æ–≤</h3>
                        <p><strong>IP:</strong> ${ip}</p>
                        <p><strong>–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–æ—Ä—Ç—ã:</strong> ${ports.join(', ')}</p>
                        <p><strong>–û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã:</strong> ${openPorts.length ? openPorts.join('<br>') : '–ù–µ –Ω–∞–π–¥–µ–Ω–æ'}</p>
                    </div>
                `;
                result.innerHTML = resultHTML;
                cache.set(`portscan_${input}`, resultHTML);
            } catch (error) {
                result.innerText = `‚ùå –û—à–∏–±–∫–∞: ${error.message} (–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–æ–π)`;
            } finally {
                button.disabled = false;
            }
        }

        async function lookupUserAgent() {
            const ua = document.getElementById('useragentInput').value.trim();
            const button = document.querySelector('#useragentSection button');
            const result = document.getElementById('useragentResult');
            const cached = cache.get(`ua_${ua}`);

            if (!ua) {
                alert(lang[currentLang].invalidUserAgent);
                return;
            }

            if (cached) {
                result.innerHTML = cached;
                return;
            }

            button.disabled = true;
            result.innerText = lang[currentLang].loading;

            try {
                const response = await fetch(`https://api.userstack.com/detect?access_key=YOUR_API_KEY&ua=${encodeURIComponent(ua)}`);
                const data = await response.json();

                if (!response.ok || data.error) {
                    throw new Error(data.error?.message || '–û—à–∏–±–∫–∞ API');
                }

                const resultHTML = `
                    <div class="info-block">
                        <h3>ü§ñ –ê–Ω–∞–ª–∏–∑ User-Agent</h3>
                        <p><strong>User-Agent:</strong> ${ua}</p>
                        <p><strong>–ë—Ä–∞—É–∑–µ—Ä:</strong> ${data.browser?.name || '–ù/–î'} ${data.browser?.version || ''}</p>
                        <p><strong>–û–°:</strong> ${data.os?.name || '–ù/–î'} ${data.os?.version || ''}</p>
                        <p><strong>–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:</strong> ${data.device?.type || '–ù/–î'} ${data.device?.brand || ''}</p>
                    </div>
                `;
                result.innerHTML = resultHTML;
                cache.set(`ua_${ua}`, resultHTML);
            } catch (error) {
                const browser = ua.match(/(firefox|chrome|safari|opera|edge|ie)/i)?.[0] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                const os = ua.match(/(windows|mac|linux|android|ios)/i)?.[0] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                const resultHTML = `
                    <div class="info-block">
                        <h3>ü§ñ –ê–Ω–∞–ª–∏–∑ User-Agent (–±–∞–∑–æ–≤—ã–π)</h3>
                        <p><strong>User-Agent:</strong> ${ua}</p>
                        <p><strong>–ë—Ä–∞—É–∑–µ—Ä:</strong> ${browser}</p>
                        <p><strong>–û–°:</strong> ${os}</p>
                        <p><strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –Ω—É–∂–µ–Ω API –∫–ª—é—á</p>
                    </div>
                `;
                result.innerHTML = resultHTML;
                cache.set(`ua_${ua}`, resultHTML);
            } finally {
                button.disabled = false;
            }
        }

        async function lookupTimezone() {
            const timeInput = document.getElementById('timezoneInput').value.trim();
            const button = document.querySelector('#timezoneSection button');
            const result = document.getElementById('timezoneResult');
            const cached = cache.get(`time_${timeInput}`);
        
            const timeDateRegex = /^(\d{2}:\d{2})(?:\s(\d{2}\.\d{2}\.\d{4}))?$/;
            if (!timeInput || !timeDateRegex.test(timeInput)) {
                alert(lang[currentLang].invalidTime);
                return;
            }
        
            if (cached) {
                result.innerHTML = cached;
                return;
            }
        
            button.disabled = true;
            result.innerText = lang[currentLang].loading;
        
            try {
                const [timePart, datePart] = timeInput.split(' ');
                const [hours, minutes] = timePart.split(':').map(Number);
                const inputTime = hours * 60 + minutes;
        
                let referenceDate = new Date();
                if (datePart) {
                    const [day, month, year] = datePart.split('.').map(Number);
                    referenceDate = new Date(year, month - 1, day);
                    if (isNaN(referenceDate.getTime())) {
                        throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –¥–∞—Ç–∞');
                    }
                }
        
                const utcTime = referenceDate.getUTCHours() * 60 + referenceDate.getUTCMinutes();
                let offset = (inputTime - utcTime) / 60;
                if (offset < -12) offset += 24;
                if (offset > 12) offset -= 24;
        
                // –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫: worldtimeapi.org —Å –ø—Ä–æ–∫—Å–∏
                const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                const apiUrl = 'http://worldtimeapi.org/api/timezone';
                let timezoneList = [];
                let validZones = [];
        
                try {
                    const response = await fetch(proxyUrl + apiUrl, {
                        headers: {
                            'User-Agent': 'OSINT-Lookup/1.0 (Contact: your-email@example.com)',
                            'Accept': 'application/json'
                        },
                        timeout: 10000
                    });
        
                    if (!response.ok) {
                        throw new Error(`–°–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—Ç–∏–ª: ${response.status} ${response.statusText}`);
                    }
        
                    timezoneList = await response.json();
        
                    validZones = await Promise.all(
                        timezoneList
                            .filter(tz => tz.includes('/'))
                            .map(async tz => {
                                try {
                                    const tzResponse = await fetch(proxyUrl + `http://worldtimeapi.org/api/timezone/${tz}`, {
                                        headers: {
                                            'User-Agent': 'OSINT-Lookup/1.0 (Contact: your-email@example.com)',
                                            'Accept': 'application/json'
                                        },
                                        timeout: 5000
                                    });
                                    const tzData = await tzResponse.json();
                                    const rawOffset = tzData.raw_offset / 3600;
                                    const dstOffset = (tzData.dst_offset || 0) / 3600;
                                    const totalOffset = datePart && tzData.dst ? rawOffset + dstOffset : rawOffset;
        
                                    if (Math.abs(totalOffset - offset) < 1) {
                                        return {
                                            name: tz,
                                            offset: totalOffset,
                                            currentTime: new Date(tzData.datetime).toLocaleTimeString('ru-RU', { timeZone: tz }),
                                            abbr: tzData.abbreviation,
                                            lat: tzData.latitude ? parseFloat(tzData.latitude) : null,
                                            lon: tzData.longitude ? parseFloat(tzData.longitude) : null
                                        };
                                    }
                                    return null;
                                } catch (err) {
                                    return null;
                                }
                            })
                    );
        
                    validZones = validZones.filter(zone => zone !== null);
                } catch (apiError) {
                    console.warn('–û—à–∏–±–∫–∞ API worldtimeapi.org:', apiError.message);
                    result.innerText += `\n‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å worldtimeapi.org: ${apiError.message}. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫...`;
        
                    // –†–µ–∑–µ—Ä–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫: —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π JSON
                    const fallbackResponse = await fetch('https://raw.githubusercontent.com/dmfilipenko/timezones.json/master/timezones.json');
                    const fallbackZones = await fallbackResponse.json();
        
                    validZones = fallbackZones
                        .filter(tz => {
                            const tzOffset = datePart && tz.isDst ? tz.dstOffset : tz.offset;
                            return Math.abs(tzOffset - offset) < 1;
                        })
                        .map(tz => ({
                            name: tz.name,
                            offset: tz.offset,
                            currentTime: new Date().toLocaleTimeString('ru-RU', { timeZone: tz.utc[0] }),
                            abbr: tz.abbr,
                            lat: null, // –ù–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ fallback
                            lon: null
                        }));
                }
        
                if (validZones.length === 0) {
                    result.innerHTML = `
                        <div class="info-block fancy-frame">
                            <h3>‚è∞ –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞</h3>
                            <p><strong>–í–≤–µ–¥–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è:</strong> ${timeInput}</p>
                            <p><strong>–°–º–µ—â–µ–Ω–∏–µ –æ—Ç UTC:</strong> ${offset >= 0 ? '+' : ''}${offset}</p>
                            <p>‚ùå –ü–æ–¥—Ö–æ–¥—è—â–∏—Ö —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
                        </div>
                    `;
                } else {
                    let resultHTML = `
                        <div class="info-block fancy-frame">
                            <h3>‚è∞ –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞</h3>
                            <p><strong>–í–≤–µ–¥–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è:</strong> ${timeInput}</p>
                            <p><strong>–°–º–µ—â–µ–Ω–∏–µ –æ—Ç UTC:</strong> ${offset >= 0 ? '+' : ''}${offset}</p>
                            <p><strong>–ù–∞–π–¥–µ–Ω–æ —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–æ–≤:</strong> ${validZones.length}</p>
                            <div class="match-container">
                    `;
        
                    validZones.forEach((zone, index) => {
                        resultHTML += `
                            <div class="match-card">
                                <h4>${zone.name}</h4>
                                <ul class="vertical-list">
                                    <li><strong>–ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞:</strong> ${zone.abbr}</li>
                                    <li><strong>–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è:</strong> ${zone.currentTime}</li>
                                    <li><strong>–°–º–µ—â–µ–Ω–∏–µ:</strong> UTC${zone.offset >= 0 ? '+' : ''}${zone.offset}</li>
                                    ${zone.lat && zone.lon ? `<li><strong>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</strong> ${zone.lat}, ${zone.lon}</li>` : ''}
                                </ul>
                            </div>
                        `;
                    });
        
                    resultHTML += `
                            </div>
                        </div>
                    `;
        
                    result.innerHTML = resultHTML;
        
                    if (validZones.some(zone => zone.lat && zone.lon)) {
                        const mapDiv = document.createElement('div');
                        mapDiv.id = 'timezoneMap';
                        mapDiv.style.height = '300px';
                        mapDiv.style.marginTop = '20px';
                        result.appendChild(mapDiv);
        
                        const map = L.map('timezoneMap').setView([0, 0], 2);
                        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                            attribution: '¬© OpenStreetMap'
                        }).addTo(map);
        
                        const bounds = [];
                        validZones.forEach(zone => {
                            if (zone.lat && zone.lon) {
                                L.marker([zone.lat, zone.lon])
                                    .addTo(map)
                                    .bindPopup(`${zone.name}<br>–í—Ä–µ–º—è: ${zone.currentTime}`);
                                bounds.push([zone.lat, zone.lon]);
                            }
                        });
        
                        if (bounds.length > 0) {
                            map.fitBounds(bounds);
                        }
                    }
                }
        
                cache.set(`time_${timeInput}`, result.innerHTML);
            } catch (error) {
                result.innerHTML = `
                    <div class="info-block fancy-frame">
                        <h3>‚è∞ –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞</h3>
                        <p><strong>–í–≤–µ–¥–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è:</strong> ${timeInput}</p>
                        <p>‚ùå –û—à–∏–±–∫–∞: ${error.message}</p>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ç–∏.</p>
                    </div>
                `;
            } finally {
                button.disabled = false;
            }
        }
        async function lookupWebArchive() {
            const url = document.getElementById('webarchiveInput').value.trim();
            const button = document.querySelector('#webarchiveSection button');
            const result = document.getElementById('webarchiveResult');
            const cached = cache.get(`webarchive_${url}`);
        
            if (!url || !/^https?:\/\/\S+$/.test(url)) {
                alert(lang[currentLang].invalidWebArchive);
                return;
            }
        
            if (cached) {
                result.innerHTML = cached;
                return;
            }
        
            button.disabled = true;
            result.innerText = lang[currentLang].loading;
        
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–∫—Å–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ CORS (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
            const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
            const archiveUrl = `https://web.archive.org/cdx/search/cdx?url=${encodeURIComponent(url)}&output=json&limit=5`;
        
            try {
                const response = await fetch(proxyUrl + archiveUrl, {
                    headers: {
                        'User-Agent': 'OSINT-Lookup/1.0 (Contact: your-email@example.com)',
                        'Accept': 'application/json'
                    },
                    timeout: 10000 // –¢–∞–π–º-–∞—É—Ç 10 —Å–µ–∫—É–Ω–¥
                });
        
                if (!response.ok) {
                    throw new Error(`–°–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—Ç–∏–ª —Å –æ—à–∏–±–∫–æ–π: ${response.status} ${response.statusText}`);
                }
        
                const data = await response.json();
        
                if (!data.length || data.length === 1) {
                    result.innerHTML = `
                        <div class="info-block">
                            <h3>üìú –ò—Å—Ç–æ—Ä–∏—è —Å–∞–π—Ç–∞</h3>
                            <p><strong>URL:</strong> ${url}</p>
                            <p>‚ùå –ê—Ä—Ö–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                            <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å <a href="https://web.archive.org/web/*/${url}" target="_blank">–≤—Ä—É—á–Ω—É—é</a></p>
                        </div>
                    `;
                    return;
                }
        
                const snapshots = data.slice(1).map(row => ({
                    timestamp: row[1],
                    url: `https://web.archive.org/web/${row[1]}/${row[2]}`
                }));
        
                const resultHTML = `
                    <div class="info-block fancy-frame">
                        <h3>üìú –ò—Å—Ç–æ—Ä–∏—è —Å–∞–π—Ç–∞</h3>
                        <p><strong>URL:</strong> ${url}</p>
                        <p><strong>–ù–∞–π–¥–µ–Ω–æ —Å–Ω–∏–º–∫–æ–≤:</strong> ${snapshots.length}</p>
                        <p><strong>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–Ω–∏–º–∫–∏:</strong></p>
                        <ul class="vertical-list">
                            ${snapshots.map(s => `
                                <li>
                                    ${s.timestamp} - <a href="${s.url}" target="_blank">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å</a>
                                </li>
                            `).join('')}
                        </ul>
                        <p><a href="https://web.archive.org/web/*/${url}" target="_blank">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Å–Ω–∏–º–∫–∏</a></p>
                    </div>
                `;
                result.innerHTML = resultHTML;
                cache.set(`webarchive_${url}`, resultHTML);
            } catch (error) {
                result.innerHTML = `
                    <div class="info-block">
                        <h3>üìú –ò—Å—Ç–æ—Ä–∏—è —Å–∞–π—Ç–∞</h3>
                        <p><strong>URL:</strong> ${url}</p>
                        <p>‚ùå –û—à–∏–±–∫–∞: ${error.message}</p>
                        <p>–ü—Ä–∏—á–∏–Ω–∞: –í–æ–∑–º–æ–∂–Ω–æ, —Å–µ—Ä–≤–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ (CORS) –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.</p>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å <a href="https://web.archive.org/web/*/${url}" target="_blank">–≤—Ä—É—á–Ω—É—é</a></p>
                    </div>
                `;
            } finally {
                button.disabled = false;
            }
        }

        window.addEventListener('load', () => {
            console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            if (!window.L) console.error('Leaflet –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è');
            if (!window.EXIF) console.error('EXIF.js –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è');
            if (!window.Papa) console.error('PapaParse –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è');
            if (!window.libphonenumber) console.error('libphonenumber –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è');
        });
    </script>



</body></html>